<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="tab-icon2.png">
    <title>Story - UNDERTALE</title>

    <!-- Functions -->
    <script>
        function goToPage(page) {
            window.location.href = page;
        }
    </script>

    <!-- Style -->
    <style>
        * {
            color: white
        }
        a {
            color:yellow
        }
        h1 {
            font-size: 5em;
            font-weight: bold;
        }
        h2 {
            font-size: 3em;
            font-weight: bold;
        }
    body {
        font-family: 'Determination', sans-serif;
        background-color: black;
    }
    button {
        font-family: 'Determination', sans-serif;
    }
    .japanese {
        font-family: 'MadouFutoMaruGothic', sans-serif;
        font-size: 1.2em;
    }

    @font-face {
        font-family: 'Determination';
        src: url('../determination.ttf') format('truetype');
    }
    @font-face {
        font-family: 'MadouFutoMaruGothic';
        src: url('madoufutomarugothic.ttf') format('truetype');
    }
    nav ul li a {
        color: rgb(255, 255, 255);
    }

    nav ul li a:hover {
        color: yellow;
    }
    </style>
</head>
<body>
    <!-- Logo -->
    <button style="border: none; background: none; cursor: pointer; margin-bottom: 10px" onclick="goToPage('WrapUpHome.html')">
        <img src="UndertaleLogo.png" alt="Undertale Logo" style="width: 400px; height: auto;">
    </button>

    <!-- Navigation Bar -->
    <nav style="background-color: rgb(0, 0, 0); padding: 0.5px; border-radius: 1px; outline: 3px solid white; margin-bottom: 20px">
        <ul style="list-style: none; display: flex; gap: 40px;">
            <li><a href="WrapUpHome.html" style="text-decoration: none; text-shadow: -1px -1px 0 black, 1px -1px 0 black, -1px 1px 0 black, 1px 1px 0 black; font-size: 20px;">Home</a></li>
            <li><a href="WrapUp2.html" style="text-decoration: none; text-shadow: -1px -1px 0 black, 1px -1px 0 black, -1px 1px 0 black, 1px 1px 0 black; font-size: 20px;">Story</a></li>
            <li><a href="WrapUp3.html" style="text-decoration: none; text-shadow: -1px -1px 0 black, 1px -1px 0 black, -1px 1px 0 black, 1px 1px 0 black; font-size: 20px;">Routes</a></li>
            <li><a href="WrapUp4.html" style="text-decoration: none; text-shadow: -1px -1px 0 black, 1px -1px 0 black, -1px 1px 0 black, 1px 1px 0 black; font-size: 20px;">Characters</a></li>
        </ul>
    </nav>

    <!-- Banner -->
    <div style="align-content: center; text-align: center; margin-bottom: 10px">
        <h1 id="banner-title" style="margin-left:40%; margin-top: 95px; position: absolute; color: white; text-shadow: 4px 4px 8px black; font-weight: bold; z-index: 99999;">Story</h1>
        <div id="banner-image" style="background-image: url('https://preview.redd.it/growing-up-is-realising-undertales-story-is-way-darker-than-v0-deceen0f37ve1.jpeg?auto=webp&s=57743eb445f70080ab3fe3e53196b4abecf00c01'); background-size: cover; background-position: center; height: 300px; border-radius: 20px; filter: blur(3px);"></div>
    </div>

    <!-- Page Content -->
    <div id="scene-container" style="text-align: center; font-size: 1.5em; margin-top: 30px;">
        <div class="scene" style="display: block;">
            <img src="https://art.pixilart.com/sr2a71dc562a2aws3.png" alt="Story Image" style="display: block; margin: 0 auto; width: 30%; height: auto; margin-bottom: 20px; border-radius: 2px;">
            <p style="width: 30%; margin: 0 auto;">Long ago, two races ruled over Earth: HUMANS and MONSTERS.<br></p>
        </div>
        <div class="scene" style="display: none;">
            <img src="https://static.wikia.nocookie.net/undertale/images/f/fb/War_of_Humans_and_Monsters_screenshot.png" alt="Story Image" style="display: block; margin: 0 auto; width: 30%; height: auto; margin-bottom: 20px; border-radius: 2px;">
            <p style="width: 30%; margin: 0 auto;">One day, war broke out between the two races.<br></p>
        </div>
        <div class="scene" style="display: none;">
            <img src="https://static.wikia.nocookie.net/undertale/images/4/40/Humans_screenshot_intro.png" alt="Story Image" style="display: block; margin: 0 auto; width: 30%; height: auto; margin-bottom: 20px; border-radius: 2px;">
            <p style="width: 30%; margin: 0 auto;">After a long battle, the humans were victorious.</p>
        </div>
        <div class="scene" style="display: none;">
            <img src="https://static.wikia.nocookie.net/undertale/images/4/40/Humans_screenshot_intro.png" alt="Story Image" style="display: block; margin: 0 auto; width: 30%; height: auto; margin-bottom: 20px; border-radius: 2px;">
            <p style="width: 30%; margin: 0 auto;">They sealed the monsters underground with a magic spell.<br></p>
        </div>
        <button 
            id="proceed-button"
            onclick="nextScene()" 
            style="margin-top: 20px; font-size: 1em; padding: 10px 20px; cursor: pointer; background-color: black; outline: 3px solid white; color: white;" 
            onmouseover="this.style.outline='3px solid yellow'; this.style.color='yellow';" 
            onmouseout="this.style.outline='3px solid white'; this.style.color='white';">
            PROCEED
        </button>
    </div>

    <script>
        let currentSceneIndex = 0;
        const charaTexts = ["Greetings.", "I am Chara.", "I forgot what to say...", "Uhhh...", "Hi?", "Oh wait, I said that already.", "Would you like to disable this easter egg so you won't see me again?"];
        const centerStyle = "display: block; margin: 0 auto; width: 30%; height: auto; margin-bottom: 20px; border-radius: 2px;";
    
        // Check if the WithoutATrace scene is disabled
        const isWithoutATraceDisabled = localStorage.getItem("disableWithoutATrace") === "true";
    
        function nextScene() {
            const scenes = document.querySelectorAll('.scene');
            const sceneContainer = document.getElementById('scene-container');
            const bannerImage = document.getElementById('banner-image');
            const bannerTitle = document.getElementById('banner-title');
    
            // Error checking for required elements
            if (!scenes.length || !sceneContainer || !bannerImage || !bannerTitle) {
                console.error("Required elements are missing from the DOM.");
                return;
            }
    
            const randomChance = Math.random();
    
            if (!isWithoutATraceDisabled && randomChance < 0.1) {
                // Show "Without A Trace" scene
                sceneContainer.innerHTML = `
                    <img src="WithoutATrace.png" alt="Without A Trace" style="${centerStyle}">
                    <p style="width: 30%; margin: 0 auto;">One Day, they all disappeared without a trace.</p>
                `;
                bannerImage.style.display = 'none';
                bannerTitle.style.display = 'none';
    
                // Switch to Chara after 5 seconds
                setTimeout(() => {
                    const image = sceneContainer.querySelector('img');
                    const text = sceneContainer.querySelector('p');
    
                    if (!image || !text) {
                        console.error("Image or text element is missing in the scene.");
                        return;
                    }
    
                    // Replace the image with Chara's sprite
                    image.src = "https://static.wikia.nocookie.net/fcs-vs-battle/images/6/60/Chara_Sprite_Vector.png";
                    image.alt = "Chara Sprite";
                    image.style.width = "10%";
    
                    // Replace the text with Chara's dialogue
                    let charaIndex = 0;
                    text.textContent = charaTexts[charaIndex];
    
                    const charaInterval = setInterval(() => {
                        charaIndex++;
                        if (charaIndex < charaTexts.length) {
                            text.textContent = charaTexts[charaIndex];
                        } else {
                            clearInterval(charaInterval);
                            showDisableButtons(sceneContainer); // Show Yes/No buttons after the last dialogue
                        }
                    }, 3000); // Show each line of dialogue every 3 seconds
                }, 5000);
            } else {
                // Proceed to the next scene
                if (!scenes[currentSceneIndex]) {
                    console.error(`Scene at index ${currentSceneIndex} is missing.`);
                    return;
                }
    
                scenes[currentSceneIndex].style.display = 'none';
                currentSceneIndex = (currentSceneIndex + 1) % scenes.length;
    
                if (!scenes[currentSceneIndex]) {
                    console.error(`Scene at index ${currentSceneIndex} is missing.`);
                    return;
                }
    
                scenes[currentSceneIndex].style.display = 'block';
            }
        }
    
        function showDisableButtons(container) {
            // Add Yes/No buttons
            container.innerHTML += `
                <div style="margin-top: 20px;">
                    <button id="yes-button" style="margin-right: 10px; padding: 10px 20px; font-size: 1em; cursor: pointer; background-color: green; color: white; border: none; border-radius: 5px;">Yes</button>
                    <button id="no-button" style="padding: 10px 20px; font-size: 1em; cursor: pointer; background-color: red; color: white; border: none; border-radius: 5px;">No</button>
                </div>
            `;
    
            // Add event listeners to the buttons
            document.getElementById("yes-button").addEventListener("click", () => {
                localStorage.setItem("disableWithoutATrace", "true"); // Disable WithoutATrace
                alert("The easter egg has been disabled. You won't see it again. - WHY DON'T YOU WANT TO SEE ME ANYMORE :( - chara (refresh)");
                nextScene(); // Proceed to the next scene
            });
    
            document.getElementById("no-button").addEventListener("click", () => {
                alert("The easter egg will remain enabled. (refresh)");
                nextScene(); // Proceed to the next scene
            });
        }
    </script>

</body>
</html>